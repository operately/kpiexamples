<% title = "#{@kpi.name} - #{@kpi.category.name} KPI Examples" -%>
<% set_page_title(title, full: true) -%>

<% content_for :head do -%>
  <%= meta_description(substring_until_period(@kpi.description)) -%>

  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="@operately">
  <meta name="twitter:title" content="<%= title %>">
  <meta name="og:description" content="<%= substring_until_period(@kpi.description) %>">
  <meta name="twitter:image" content="<%= image_url("summary-card.jpg") %>">
  <meta name="og:image" content="<%= image_url("summary-card.jpg") %>">
<% end -%>

<div class="flex flex-row items-center space-x-2">
  <ol itemscope itemtype="https://schema.org/BreadcrumbList" class="flex flex-wrap">
    <li itemprop="itemListElement" itemscope
        itemtype="https://schema.org/ListItem" class="mr-2">
      <%= link_to(category_url(@kpi.category), class: "text-operately-blue hover:text-operately-dark-blue underline", itemprop: "item") do %>
        <span itemprop="name"><%= @kpi.category.name %></span></a>
    <% end %>
    <meta itemprop="position" content="1" />
    </li>
    â€º
    <li itemprop="itemListElement" itemscope
        itemtype="https://schema.org/ListItem" class="ml-2">
      <%= link_to(category_subcategory_url(@kpi.category, @kpi.subcategory), class: "text-operately-blue hover:text-operately-dark-blue underline", itemprop: "item") do %>
        <span itemprop="name"><%= @kpi.subcategory.name %></span></a>
    <% end %>
    <meta itemprop="position" content="2" />
    </li>
  </ol>
</div>

<h1 class="text-4xl font-bold mt-2"><%= @kpi.name %></h1>

<p class="text-lg text-gray-500"><%= @kpi.unit.capitalize %></p>

<div class="text-gray-800">
  <p class=""><%= @kpi.description %></p>

  <% if @kpi.formula.present? -%>
    <div class="mt-3">
      <h2 class="text-xl font-semibold mt-4 mb-1">Formula</h2>
      <p class="font-mono"><%= @kpi.formula %></p>
    </div>
  <% end -%>

  <% if @kpi.example.present? -%>
    <div class="mt-3">
      <h2 class="text-xl font-semibold mt-4 mb-1">Example</h2>
      <p><%= @kpi.example %></p>
    </div>
  <% end -%>

  <div class="mt-9 text-base">
    <hr/>
    <h3 class="mt-3 text-lg underline decoration-dotted">Other KPIs in <%= @kpi.subcategory.name %></h3>
    <ul class="list-disc list-inside mt-2 mb-2">
      <% @other_kpis.each do |kpi| -%>
        <li class="mb-2"><%= link_to(kpi.name, category_kpi_path(kpi.category, kpi), class: "text-operately-blue hover:text-operately-dark-blue underline") %></li>
      <% end -%>
    </ul>
  </div>
</div>
